
--[[
--æ— éšœç¢ç‰ˆä¸“ç”¨è„šæœ¬
--è„šæœ¬å¯åŠ¨å™¨
--ç‰ˆæœ¬å·: 1.4
--åˆ¶ä½œæ—¥æœŸ
â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚
æ—¥æœŸ: 2020å¹´05æœˆ07æ—¥ğŸ—“ï¸
å†œå†: é¼ (åºšå­)å¹´å››æœˆåäº”
æ—¶é—´: 15:25:05ğŸ•’
æ˜ŸæœŸ: å‘¨å››
--ç”¨é€”ï¼šç”¨äºå¯åŠ¨æŒ‡å®šç›®å½•ä¸‹ç›¸å…³è„šæœ¬,ç”Ÿæˆé”®ç›˜,ç‚¹å‡»ä½¿ç”¨ç›¸å…³è„šæœ¬åŠŸèƒ½
--åˆ¶ä½œè€…: é£ä¹‹æ¼«èˆ
--é¦–å‘qqç¾¤: åŒæ–‡å ‚(480159874)
--é‚®ç®±: bj19490007@163.com(ä¸ä¸€å®šåŠæ—¶çœ‹åˆ°)

]]


require "import"
import "java.io.File"
import "android.os.*"

import "script.åŒ….å…¶å®ƒ.ä¸»é”®ç›˜"

local å‚æ•°=(...)
local ç¼–å·=1

local è„šæœ¬ç›®å½•=tostring(service.getLuaExtDir("script"))
local è„šæœ¬å=debug.getinfo(1,"S").source:sub(2)--è·å–Luaè„šæœ¬çš„å®Œæ•´è·¯å¾„

local è„šæœ¬ç›¸å¯¹è·¯å¾„=string.sub(è„šæœ¬å,#è„šæœ¬ç›®å½•+1)
local çº¯è„šæœ¬å=File(è„šæœ¬å).getName()
local çº¯è„šæœ¬åæ— åç¼€=File(è„šæœ¬å).getName():sub(1,-5)
local ç›®å½•=string.sub(è„šæœ¬å,1,#è„šæœ¬å-#çº¯è„šæœ¬å).."è„šæœ¬åº“"




import "script.åŒ….æ–‡ä»¶æ“ä½œ.é€’å½’æŸ¥æ‰¾æ–‡ä»¶"
local æ–‡ä»¶ç»„=é€’å½’æŸ¥æ‰¾æ–‡ä»¶(File(ç›®å½•),".lua$")
--å–è„šæœ¬ç›¸å¯¹è·¯å¾„
for i=1,#æ–‡ä»¶ç»„ do
 æ–‡ä»¶ç»„[i]=string.sub(æ–‡ä»¶ç»„[i],#è„šæœ¬ç›®å½•+1)
end





if string.sub(å‚æ•°,1,1)=="<" && string.sub(å‚æ•°,3,3)==">" then
 ç¼–å·=tonumber(string.sub(å‚æ•°,2,2))
end

table.sort(æ–‡ä»¶ç»„)--æ•°ç»„æ’åº

local æŒ‰é”®ç»„={}
local çŸ­è¯­æ•°=18--å•ä¸ªé”®ç›˜çš„çŸ­è¯­æ•°é‡
local é»˜è®¤å®½åº¦=33

--å†™ç¼–å·æç¤º
local æ€»åºå·=math.ceil(#æ–‡ä»¶ç»„/25)
local æŒ‰é”®={}
 æŒ‰é”®["width"]=100
-- æŒ‰é”®["height"]=25
 æŒ‰é”®["click"]=""
 æŒ‰é”®["label"]=string.sub(çº¯è„šæœ¬å,1,#çº¯è„šæœ¬å-4).."("..ç¼–å·.."/"..æ€»åºå·..")"
 æŒ‰é”®ç»„[#æŒ‰é”®ç»„+1]=æŒ‰é”®




if ç¼–å·==1 then
 if #æ–‡ä»¶ç»„<25 then
  for i=1,#æ–‡ä»¶ç»„ do
   local æŒ‰é”®={}
   æŒ‰é”®["label"]=File(æ–‡ä»¶ç»„[i]).getName():sub(1,-5)
   æŒ‰é”®["click"]={label=æŒ‰é”®["label"], send="function",command= æ–‡ä»¶ç»„[i],option= "1"}
   æŒ‰é”®ç»„[#æŒ‰é”®ç»„+1]=æŒ‰é”®
   
   
  end--for i=1,#æ–‡ä»¶ç»„
  local æŒ‰é”®={}
  æŒ‰é”®["width"]=20
  for i=1,24-#æ–‡ä»¶ç»„ do
   æŒ‰é”®ç»„[#æŒ‰é”®ç»„+1]=æŒ‰é”®
  end--for
  æŒ‰é”®ç»„[#æŒ‰é”®ç»„+1]=ä¸»é”®ç›˜()
 else
  for i=1,23 do
   local å­ç¼–å·=i
   if #æ–‡ä»¶ç»„>å­ç¼–å·-1 then
    local æŒ‰é”®={}
   æŒ‰é”®["label"]=File(æ–‡ä»¶ç»„[å­ç¼–å·]).getName():sub(1,-5)
   æŒ‰é”®["click"]={label=æŒ‰é”®["label"], send="function",command= æ–‡ä»¶ç»„[å­ç¼–å·],option= "1"}
   æŒ‰é”®ç»„[#æŒ‰é”®ç»„+1]=æŒ‰é”®
   end--if
  end--for

 local æŒ‰é”®={}
 æŒ‰é”®["click"]={label="â–¶", send="function",command= è„šæœ¬ç›¸å¯¹è·¯å¾„,option= "<"..(ç¼–å·+1)..">"}
 æŒ‰é”®ç»„[#æŒ‰é”®ç»„+1]=æŒ‰é”®
 æŒ‰é”®ç»„[#æŒ‰é”®ç»„+1]=ä¸»é”®ç›˜()

 end--if #æ–‡ä»¶ç»„<25
end--if ç¼–å·==1

if ç¼–å·>1 then
if #æ–‡ä»¶ç»„<ç¼–å·*23 then
  for i=1,22 do
   local å­ç¼–å·=i
   local ä½ç½®=å­ç¼–å·+(ç¼–å·-1)*23
   if #æ–‡ä»¶ç»„>ä½ç½® then
    local æŒ‰é”®={}
    æŒ‰é”®["label"]=File(æ–‡ä»¶ç»„[ä½ç½®]).getName():sub(1,-5)
    æŒ‰é”®["click"]={label=æŒ‰é”®["label"], send="function",command= æ–‡ä»¶ç»„[ä½ç½®],option= "1"}
    æŒ‰é”®ç»„[#æŒ‰é”®ç»„+1]=æŒ‰é”®
   end--if
  end--for
  local æŒ‰é”®={}
  æŒ‰é”®["width"]=20
  for i=1,23*ç¼–å·-#æ–‡ä»¶ç»„ do
   æŒ‰é”®ç»„[#æŒ‰é”®ç»„+1]=æŒ‰é”®
  end--for
  local æŒ‰é”®={}
  æŒ‰é”®["click"]={label="â—€", send="function",command= è„šæœ¬ç›¸å¯¹è·¯å¾„,option= "<"..(ç¼–å·-1)..">"}
 æŒ‰é”®ç»„[#æŒ‰é”®ç»„+1]=æŒ‰é”®
 æŒ‰é”®ç»„[#æŒ‰é”®ç»„+1]=ä¸»é”®ç›˜()
else
  for i=1,22 do
   local å­ç¼–å·=i
   local ä½ç½®=å­ç¼–å·+(ç¼–å·-1)*23
   if #æ–‡ä»¶ç»„>ä½ç½® then
    local æŒ‰é”®={}
    æŒ‰é”®["label"]=File(æ–‡ä»¶ç»„[ä½ç½®]).getName():sub(1,-5)
    æŒ‰é”®["click"]={label=æŒ‰é”®["label"], send="function",command= æ–‡ä»¶ç»„[ä½ç½®],option= "1"}
    æŒ‰é”®ç»„[#æŒ‰é”®ç»„+1]=æŒ‰é”®
   end--if
  end--for
  local æŒ‰é”®={}
 æŒ‰é”®["click"]={label="â—€", send="function",command= è„šæœ¬ç›¸å¯¹è·¯å¾„,option= "<"..(ç¼–å·-1)..">"}
 æŒ‰é”®ç»„[#æŒ‰é”®ç»„+1]=æŒ‰é”®
 local æŒ‰é”®={}
 æŒ‰é”®["click"]={label="â–¶", send="function",command= è„šæœ¬ç›¸å¯¹è·¯å¾„,option= "<"..(ç¼–å·+1)..">"}
 
 æŒ‰é”®ç»„[#æŒ‰é”®ç»„+1]=æŒ‰é”®
 
 
 æŒ‰é”®ç»„[#æŒ‰é”®ç»„+1]=ä¸»é”®ç›˜()

end--if #æ–‡ä»¶ç»„>ç¼–å·*22
end--if ç¼–å·>1 


--print(8%5)

for i=1,#æŒ‰é”®ç»„ do
 if i%2==1 then
  æŒ‰é”®ç»„[i]["key_back_color"]="#key_back_color"
 end
end



service.setKeyboard{
  name=çº¯è„šæœ¬åæ— åç¼€,
  ascii_mode=0,
  width=20,
  height=44,
  keys=æŒ‰é”®ç»„
  }





















